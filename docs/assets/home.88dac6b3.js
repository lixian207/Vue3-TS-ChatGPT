import{d as G,r as a,o as J,n as L,w as $,c as v,a as s,b as c,e as r,F as D,f as S,u as _,i as I,g as q,E as k,h as g,j as d,k as h,t as Q,l as z}from"./index.d73ed6a4.js";import{o as W,m as X,V as Y,c as Z,D as ee,L as te}from"./highlight.ff38b73f.js";const se={class:"flex flex-col h-screen"},le={class:"flex flex-nowrap fixed w-full items-baseline top-0 px-6 py-4 bgColor"},ue=s("div",{class:"text-2xl font-bold text-white"},"\u795E\u5947\u6D77\u87BA",-1),ae=s("div",{class:"ml-4 text-sm text-white"}," \u53EF\u4EE5\u547C\u5524\u795E\u5947\u6D77\u87BA\uFF0C\u795E\u5947\u6D77\u87BA\u4F1A\u5E2E\u4F60\u89E3\u51B3\u95EE\u9898 ",-1),oe={class:"flex-1 mt-16 content"},ne={class:"font-bold mb-3 text-lg"},ie=["innerHTML"],ce={class:"sticky bottom-0 w-full p-6 bgColor pb-0"},re={class:"flex items-center"},de=s("div",{class:"w-full bgColor flex items-center justify-center",style:{"line-height":"40px"}},[s("a",{class:"jb",href:"https://beian.miit.gov.cn/",target:"_blank"},"\u4EACICP\u59072022029426\u53F7-1")],-1),pe={class:"bottom-0 w-full p-6 pb-8"},fe={class:"flex items-center"},me=s("span",{class:"w-1/6 font-bold"},"API Key",-1),ve={class:"flex items-center mt-5"},_e=s("span",{class:"w-1/6 font-bold"},"\u7248\u672C",-1),Ee=G({__name:"home",setup(ge){const C=a(null),p=a(!1),F=a(),N={user:"ME",assistant:"Magic Conch",system:"System"},l=a([{role:"system",content:"\u4F60\u662F ChatGPT\uFF0COpenAI \u8BAD\u7EC3\u7684\u5927\u578B\u8BED\u8A00\u6A21\u578B\uFF0C\u5C3D\u53EF\u80FDAuthentic, concise,accurate\u7684\u56DE\u7B54\u95EE\u9898\u3002"},{role:"assistant",content:`
    \u4F60\u597D\uFF0C\u6211\u662F\u795E\u5947\u6D77\u87BA\uFF0C\u6B22\u8FCE\u63D0\u95EE
    `}]),B=a("gpt-3.5-turbo");let x=a(!0),b=a(!1),f=a(""),o=a("");const{getKey:y,setKey:R}=W();J(()=>{y()&&U(),V()});const j=()=>{o.value.slice(0,3)!=="sk-"||o.value.length!==51?k({message:"\u8BF7\u586B\u5199 Key",type:"warning"}):(R(o.value),k({message:"Key \u8BBE\u7F6E\u6210\u529F",type:"success"}),p.value=!1)},O=async(n=f.value)=>{b.value=!0,l.value.length===2&&l.value.pop(),l.value.push({role:"user",content:n}),T(),l.value.push({role:"assistant",content:""});const{status:t,data:u,message:i}=await Z(l.value,y(),B.value);if(t==="success"&&u){const m=u.getReader();await A(m)}else K(i);b.value=!1,V()},V=()=>{L(()=>{C.value&&C.value.focus()})},A=async n=>{const{done:t,value:u}=await n.read();if(t){n.closed;return}const i=ee.decode(u).match(new RegExp("(?<=data: )\\s*({.*?}]})","g"));i==null||i.forEach(m=>{var E;const w=JSON.parse(m);K((E=w.choices[0].delta.content)!=null?E:"")}),await A(n)},K=n=>l.value[l.value.length-1].content+=n,M=()=>{y().length===51?O():k({message:"\u60A8\u597D\u50CF\u6CA1\u6709\u586B\u5199Key",type:"warning"})},P=()=>{console.log(!x.value),x.value?T():(o.value=y(),p.value=!0),p.value=!0},U=()=>x.value=!x.value,T=()=>f.value="";$(l.value,()=>L(()=>H()));const H=()=>{if(F.value)scrollTo(0,F.value.scrollHeight);else return};return(n,t)=>{const u=g("el-button"),i=g("el-input"),m=g("el-option"),w=g("el-select"),E=g("el-dialog");return d(),v(D,null,[s("div",se,[s("div",le,[ue,ae,s("div",{class:"ml-auto text-sm cursor-pointer",onClick:P},[c(u,{size:"large",type:"info",class:"elBtnStyle text-5xl"},{default:r(()=>[h("\u8BBE\u7F6E")]),_:1})])]),s("div",oe,[s("div",{class:"m-6",ref_key:"chatListDom",ref:F},[(d(!0),v(D,null,S(l.value.filter(e=>e.role!=="system"),e=>(d(),v("div",null,[s("div",ne,Q(N[e.role])+"\uFF1A",1),e.content?(d(),v("div",{key:0,class:"text-base text-black whitespace-pre-wrap",innerHTML:_(X)(e.content.replace(/^\n\n/,""))},null,8,ie)):(d(),z(te,{key:1}))]))),256))],512)]),s("div",ce,[s("div",re,[c(i,{class:"input",rows:1,type:"textarea",ref_key:"myInput",ref:C,modelValue:_(f),"onUpdate:modelValue":t[0]||(t[0]=e=>I(f)?f.value=e:f=e),size:"large",onKeydown:t[1]||(t[1]=q(e=>M(),["enter"])),disabled:_(b)},null,8,["modelValue","disabled"]),c(u,{onClick:t[2]||(t[2]=e=>M()),size:"large",type:"info",class:"elBtnStyle text-5xl ml-5"},{default:r(()=>[h("\u53D1\u9001 ")]),_:1})])]),de]),c(E,{modelValue:p.value,"onUpdate:modelValue":t[6]||(t[6]=e=>p.value=e),title:"\u795E\u5947\u6D77\u87BA \u8BBE\u7F6E",width:"40%",center:""},{footer:r(()=>[s("span",null,[c(u,{onClick:t[5]||(t[5]=e=>p.value=!1)},{default:r(()=>[h("\u5173\u95ED")]),_:1}),c(u,{type:"primary",onClick:j},{default:r(()=>[h("\u4FDD\u5B58")]),_:1})])]),default:r(()=>[s("div",pe,[s("div",fe,[me,c(i,{placeholder:"sk-xxxxxxxxxx",modelValue:_(o),"onUpdate:modelValue":t[3]||(t[3]=e=>I(o)?o.value=e:o=e),size:"large",clearable:""},null,8,["modelValue"])]),s("div",ve,[_e,c(w,{size:"large",class:"w-full",modelValue:B.value,"onUpdate:modelValue":t[4]||(t[4]=e=>B.value=e)},{default:r(()=>[(d(!0),v(D,null,S(_(Y),e=>(d(),z(m,{key:e.id,label:e.id,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue"])],64)}}});export{Ee as default};
