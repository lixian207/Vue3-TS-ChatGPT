import{d as q,r as o,o as G,n as T,w as J,c as v,a as t,b as c,e as r,F as k,f as L,u as g,i as z,g as Y,E as D,h as _,j as d,k as h,t as $,l as N}from"./index.54f883d7.js";import{o as Q,m as W,V as X,c as Z,D as ee,L as se}from"./highlight.bd7ba0ea.js";const te={class:"flex flex-col h-screen"},le={class:"flex flex-nowrap fixed w-full items-baseline top-0 px-6 py-4 bgColor"},ae=t("div",{class:"text-2xl font-bold text-white"},"\u795E\u5947\u6D77\u87BA",-1),oe=t("div",{class:"ml-4 text-sm text-white"}," \u53EF\u4EE5\u547C\u5524\u795E\u5947\u6D77\u87BA\uFF0C\u795E\u5947\u6D77\u87BA\u4F1A\u5E2E\u4F60\u89E3\u51B3\u95EE\u9898 ",-1),ne={class:"flex-1 mt-16 content"},ue={class:"font-bold mb-3 text-lg"},ie=["innerHTML"],ce={class:"sticky w-full p-6 bgColor pb-6"},re={class:"flex items-center"},de={class:"bottom-0 w-full p-6 pb-8"},pe={class:"flex items-center"},me=t("span",{class:"w-1/6 font-bold"},"API Key",-1),fe={class:"flex items-center mt-5"},ve=t("span",{class:"w-1/6 font-bold"},"\u7248\u672C",-1),ye=q({__name:"home",setup(ge){const E=o(null),p=o(!1),w=o(),P={user:"ME",assistant:"Magic Conch",system:"System"},l=o([{role:"system",content:"You are ChatGPT, Please answer my questions in a simple, easy-to-understand, and detailed manner. Please prioritize Chinese answers and provide straightforward examples when answering questions as much as possible."},{role:"assistant",content:`
    \u4F60\u597D\uFF0C\u6211\u662F\u795E\u5947\u6D77\u87BA\uFF0C\u6B22\u8FCE\u63D0\u95EE
    `}]),C=o("gpt-3.5-turbo");let x=o(!0),b=o(!1),m=o(""),n=o("");const{getKey:y,setKey:R}=Q();G(()=>{y()&&H(),V()});const I=()=>{n.value.slice(0,3)!=="sk-"||n.value.length!==51?D({message:"\u8BF7\u586B\u5199 Key",type:"warning"}):(R(n.value),D({message:"Key \u8BBE\u7F6E\u6210\u529F",type:"success"}),p.value=!1)},U=async(u=m.value)=>{b.value=!0,l.value.length===2&&l.value.pop(),l.value.push({role:"user",content:u}),S(),l.value.push({role:"assistant",content:""});const{status:s,data:a,message:i}=await Z(l.value,y(),C.value);if(s==="success"&&a){const f=a.getReader();await A(f)}else K(i);b.value=!1,V()},V=()=>{T(()=>{E.value&&E.value.focus()})},A=async u=>{const{done:s,value:a}=await u.read();if(s){u.closed;return}const i=ee.decode(a).match(/data: \s*({.*?}]})/g);i==null||i.forEach(f=>{var e;const B=f.replace("data: ",""),F=JSON.parse(B);K((e=F.choices[0].delta.content)!=null?e:"")}),await A(u)},K=u=>l.value[l.value.length-1].content+=u,M=()=>{y().length===51?U():D({message:"\u60A8\u597D\u50CF\u6CA1\u6709\u586B\u5199Key",type:"warning"})},j=()=>{console.log(!x.value),x.value?S():(n.value=y(),p.value=!0),p.value=!0},H=()=>x.value=!x.value,S=()=>m.value="";J(l.value,()=>T(()=>O()));const O=()=>{if(w.value)scrollTo(0,w.value.scrollHeight);else return};return(u,s)=>{const a=_("el-button"),i=_("el-input"),f=_("el-option"),B=_("el-select"),F=_("el-dialog");return d(),v(k,null,[t("div",te,[t("div",le,[ae,oe,t("div",{class:"ml-auto text-sm cursor-pointer",onClick:j},[c(a,{size:"large",type:"info",class:"elBtnStyle text-5xl"},{default:r(()=>[h("\u8BBE\u7F6E")]),_:1})])]),t("div",ne,[t("div",{class:"m-6",ref_key:"chatListDom",ref:w},[(d(!0),v(k,null,L(l.value.filter(e=>e.role!=="system"),e=>(d(),v("div",null,[t("div",ue,$(P[e.role])+"\uFF1A",1),e.content?(d(),v("div",{key:0,class:"text-base text-black whitespace-pre-wrap",innerHTML:g(W)(e.content.replace(/^\n\n/,""))},null,8,ie)):(d(),N(se,{key:1}))]))),256))],512)]),t("div",ce,[t("div",re,[c(i,{class:"input",rows:1,type:"textarea",ref_key:"myInput",ref:E,modelValue:g(m),"onUpdate:modelValue":s[0]||(s[0]=e=>z(m)?m.value=e:m=e),size:"large",onKeydown:s[1]||(s[1]=Y(e=>M(),["enter"])),disabled:g(b)},null,8,["modelValue","disabled"]),c(a,{onClick:s[2]||(s[2]=e=>M()),size:"large",type:"info",class:"elBtnStyle text-5xl ml-5"},{default:r(()=>[h("\u53D1\u9001 ")]),_:1})])])]),c(F,{modelValue:p.value,"onUpdate:modelValue":s[6]||(s[6]=e=>p.value=e),title:"\u795E\u5947\u6D77\u87BA \u8BBE\u7F6E",width:"80%",center:""},{footer:r(()=>[t("span",null,[c(a,{onClick:s[5]||(s[5]=e=>p.value=!1)},{default:r(()=>[h("\u5173\u95ED")]),_:1}),c(a,{type:"primary",onClick:I},{default:r(()=>[h("\u4FDD\u5B58")]),_:1})])]),default:r(()=>[t("div",de,[t("div",pe,[me,c(i,{placeholder:"sk-xxxxxxxxxx",modelValue:g(n),"onUpdate:modelValue":s[3]||(s[3]=e=>z(n)?n.value=e:n=e),size:"large",clearable:""},null,8,["modelValue"])]),t("div",fe,[ve,c(B,{size:"large",class:"w-full",modelValue:C.value,"onUpdate:modelValue":s[4]||(s[4]=e=>C.value=e)},{default:r(()=>[(d(!0),v(k,null,L(g(X),e=>(d(),N(f,{key:e.id,label:e.id,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue"])],64)}}});export{ye as default};
