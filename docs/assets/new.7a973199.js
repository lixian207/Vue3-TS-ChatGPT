import{d as J,r as a,o as $,n as S,w as q,c as v,a as s,b as c,e as r,F as D,f as L,u as _,i as I,g as Q,E as k,h as g,j as d,k as y,t as W,l as N}from"./index.dc7c2935.js";import{o as X,m as Y,V as Z,c as ee,D as te,L as se}from"./highlight.6383f2b7.js";const le={class:"flex flex-col w-full h-screen"},ue={class:"flex flex-nowrap fixed w-full items-baseline top-0 px-6 py-4 bgColor"},ae=s("div",{class:"text-2xl font-bold text-white"},"\u795E\u5947\u6D77\u87BA",-1),oe=s("div",{class:"ml-4 text-sm text-white"}," \u53EF\u4EE5\u547C\u5524\u795E\u5947\u6D77\u87BA\uFF0C\u795E\u5947\u6D77\u87BA\u4F1A\u5E2E\u4F60\u89E3\u51B3\u95EE\u9898 ",-1),ne={class:"flex-1 mt-16 content"},ie={class:"font-bold mb-3 text-lg"},ce=["innerHTML"],re={class:"sticky bottom-0 w-full p-6 bgColor pb-0"},de={class:"flex items-center"},fe=s("div",{class:"w-full bgColor flex items-center justify-center",style:{"line-height":"40px"}},[s("a",{class:"jb",href:"https://beian.miit.gov.cn/",target:"_blank"},"\u4EACICP\u59072022029426\u53F7-1")],-1),pe={class:"bottom-0 w-full p-6 pb-8"},me={class:"flex items-center"},ve=s("span",{class:"w-1/6 font-bold"},"API Key",-1),_e={class:"flex items-center mt-5"},ge=s("span",{class:"w-1/6 font-bold"},"\u7248\u672C",-1),Ce=J({__name:"new",setup(Ee){const R=Z,C=a(null),f=a(!1),h=a(),z={user:"ME",assistant:"Magic Conch",system:"System"},l=a([{role:"system",content:"\u4F60\u662FChatGPT,\u5C3D\u53EF\u80FD\u7CBE\u51C6\u7684\u3001\u771F\u5B9E\u7684\u3001\u66F4\u52A0\u6613\u61C2\u7684\u56DE\u7B54\u6211\u7684\u95EE\u9898\u3002\u4F18\u5148\u9009\u62E9\u4E2D\u6587\u56DE\u7B54,\u5176\u6B21\u9009\u62E9\u82F1\u6587\u3002"},{role:"assistant",content:`
    \u4F60\u597D\uFF0C\u6211\u662F\u795E\u5947\u6D77\u87BA\uFF0C\u6B22\u8FCE\u63D0\u95EE
    `}]),F=a("gpt-3.5-turbo");let B=a(!0),b=a(!1),p=a(""),o=a("");const{getKey:E,setKey:P}=X();$(()=>{E()&&G(),V()});const j=()=>{o.value.slice(0,3)!=="sk-"||o.value.length!==51?k({message:"\u8BF7\u586B\u5199 Key",type:"warning"}):(P(o.value),k({message:"\u8BBE\u7F6E\u6210\u529F",type:"success"}),f.value=!1)},O=async(n=p.value)=>{b.value=!0,l.value.length===2&&l.value.pop(),l.value.push({role:"user",content:n}),T(),l.value.push({role:"assistant",content:""});const{status:t,data:u,message:i}=await ee(l.value,E(),F.value);if(t==="success"&&u){const m=u.getReader();await A(m)}else K(i);b.value=!1,V()},V=()=>{S(()=>{C.value&&C.value.focus()})},A=async n=>{const{done:t,value:u}=await n.read();if(t){n.closed;return}const i=te.decode(u).match(new RegExp("(?<=data: )\\s*({.*?}]})","g"));i==null||i.forEach(m=>{var x;const w=JSON.parse(m);K((x=w.choices[0].delta.content)!=null?x:"")}),await A(n)},K=n=>l.value[l.value.length-1].content+=n,M=()=>{E().length===51?O():k({message:"\u60A8\u597D\u50CF\u6CA1\u6709\u586B\u5199Key",type:"warning"})},U=()=>{B.value?T():(o.value=E(),f.value=!0),f.value=!0},G=()=>B.value=!B.value,T=()=>p.value="";q(l.value,()=>S(()=>H()));const H=()=>{if(h.value)scrollTo(0,h.value.scrollHeight);else return};return(n,t)=>{const u=g("el-button"),i=g("el-input"),m=g("el-option"),w=g("el-select"),x=g("el-dialog");return d(),v(D,null,[s("div",le,[s("div",ue,[ae,oe,s("div",{class:"ml-auto text-sm cursor-pointer",onClick:U},[c(u,{size:"large",type:"info",class:"elBtnStyle text-5xl"},{default:r(()=>[y("\u8BBE\u7F6E")]),_:1})])]),s("div",ne,[s("div",{class:"m-6",ref_key:"chatListDom",ref:h},[(d(!0),v(D,null,L(l.value.filter(e=>e.role!=="system"),e=>(d(),v("div",null,[s("div",ie,W(z[e.role])+"\uFF1A",1),e.content?(d(),v("div",{key:0,class:"text-base text-black whitespace-pre-wrap",innerHTML:_(Y)(e.content.replace(/^\n\n/,""))},null,8,ce)):(d(),N(se,{key:1}))]))),256))],512)]),s("div",re,[s("div",de,[c(i,{class:"input",rows:1,type:"textarea",ref_key:"myInput",ref:C,modelValue:_(p),"onUpdate:modelValue":t[0]||(t[0]=e=>I(p)?p.value=e:p=e),size:"large",onKeydown:t[1]||(t[1]=Q(e=>M(),["enter"])),disabled:_(b)},null,8,["modelValue","disabled"]),c(u,{onClick:t[2]||(t[2]=e=>M()),size:"large",type:"info",class:"elBtnStyle text-5xl ml-5"},{default:r(()=>[y("\u53D1\u9001 ")]),_:1})])]),fe]),c(x,{modelValue:f.value,"onUpdate:modelValue":t[6]||(t[6]=e=>f.value=e),title:"\u795E\u5947\u6D77\u87BA \u8BBE\u7F6E",width:"40%",center:""},{footer:r(()=>[s("span",null,[c(u,{onClick:t[5]||(t[5]=e=>f.value=!1)},{default:r(()=>[y("\u5173\u95ED")]),_:1}),c(u,{type:"primary",onClick:j},{default:r(()=>[y("\u4FDD\u5B58")]),_:1})])]),default:r(()=>[s("div",pe,[s("div",me,[ve,c(i,{placeholder:"sk-xxxxxxxxxx",modelValue:_(o),"onUpdate:modelValue":t[3]||(t[3]=e=>I(o)?o.value=e:o=e),size:"large",clearable:""},null,8,["modelValue"])]),s("div",_e,[ge,c(w,{size:"large",class:"w-full",modelValue:F.value,"onUpdate:modelValue":t[4]||(t[4]=e=>F.value=e)},{default:r(()=>[(d(!0),v(D,null,L(_(R),e=>(d(),N(m,{key:e.id,label:e.id,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue"])],64)}}});export{Ce as default};
