import{d as q,r as o,o as G,n as L,w as J,c as v,a as t,b as c,e as r,F as k,f as S,u as g,i as z,g as Y,E as D,h as _,j as d,k as E,t as $,l as N}from"./index.901841fd.js";import{o as Q,m as W,V as X,c as Z,D as ee,L as se}from"./highlight.6bc4b5d5.js";const te={class:"flex flex-col h-screen"},le={class:"flex flex-nowrap fixed w-full items-baseline top-0 px-6 py-4 bgColor"},ae=t("div",{class:"text-2xl font-bold text-white"},"\u795E\u5947\u6D77\u87BA",-1),oe=t("div",{class:"ml-4 text-sm text-white"}," \u53EF\u4EE5\u547C\u5524\u795E\u5947\u6D77\u87BA\uFF0C\u795E\u5947\u6D77\u87BA\u4F1A\u5E2E\u4F60\u89E3\u51B3\u95EE\u9898 ",-1),ne={class:"flex-1 mt-16 content"},ue={class:"font-bold mb-3 text-lg"},ie=["innerHTML"],ce={class:"sticky w-full p-6 bgColor pb-6"},re={class:"flex items-center"},de={class:"bottom-0 w-full p-6 pb-8"},pe={class:"flex items-center"},fe=t("span",{class:"w-1/6 font-bold"},"API Key",-1),me={class:"flex items-center mt-5"},ve=t("span",{class:"w-1/6 font-bold"},"\u7248\u672C",-1),xe=q({__name:"home",setup(ge){const w=o(null),p=o(!1),C=o(),P={user:"ME",assistant:"Magic Conch",system:"System"},l=o([{role:"system",content:"You are ChatGPT, answer my questions in a simple, easy-to-understand and detailed way. Please prioritize Chinese answers, followed by English. Please provide examples when answering questions if possible."},{role:"assistant",content:`
    \u4F60\u597D\uFF0C\u6211\u662F\u795E\u5947\u6D77\u87BA\uFF0C\u6B22\u8FCE\u63D0\u95EE
    `}]),b=o("gpt-3.5-turbo");let y=o(!0),B=o(!1),f=o(""),n=o("");const{getKey:x,setKey:R}=Q();G(()=>{x()&&O(),V()});const I=()=>{n.value.slice(0,3)!=="sk-"||n.value.length!==51?D({message:"\u8BF7\u586B\u5199 Key",type:"warning"}):(R(n.value),D({message:"Key \u8BBE\u7F6E\u6210\u529F",type:"success"}),p.value=!1)},U=async(u=f.value)=>{B.value=!0,l.value.length===2&&l.value.pop(),l.value.push({role:"user",content:u}),T(),l.value.push({role:"assistant",content:""});const{status:s,data:a,message:i}=await Z(l.value,x(),b.value);if(s==="success"&&a){const m=a.getReader();await A(m)}else K(i);B.value=!1,V()},V=()=>{L(()=>{w.value&&w.value.focus()})},A=async u=>{const{done:s,value:a}=await u.read();if(s){u.closed;return}const i=ee.decode(a).match(new RegExp("(?<=data: )\\s*({.*?}]})","g"));i==null||i.forEach(m=>{var h;const F=JSON.parse(m);K((h=F.choices[0].delta.content)!=null?h:"")}),await A(u)},K=u=>l.value[l.value.length-1].content+=u,M=()=>{x().length===51?U():D({message:"\u60A8\u597D\u50CF\u6CA1\u6709\u586B\u5199Key",type:"warning"})},H=()=>{console.log(!y.value),y.value?T():(n.value=x(),p.value=!0),p.value=!0},O=()=>y.value=!y.value,T=()=>f.value="";J(l.value,()=>L(()=>j()));const j=()=>{if(C.value)scrollTo(0,C.value.scrollHeight);else return};return(u,s)=>{const a=_("el-button"),i=_("el-input"),m=_("el-option"),F=_("el-select"),h=_("el-dialog");return d(),v(k,null,[t("div",te,[t("div",le,[ae,oe,t("div",{class:"ml-auto text-sm cursor-pointer",onClick:H},[c(a,{size:"large",type:"info",class:"elBtnStyle text-5xl"},{default:r(()=>[E("\u8BBE\u7F6E")]),_:1})])]),t("div",ne,[t("div",{class:"m-6",ref_key:"chatListDom",ref:C},[(d(!0),v(k,null,S(l.value.filter(e=>e.role!=="system"),e=>(d(),v("div",null,[t("div",ue,$(P[e.role])+"\uFF1A",1),e.content?(d(),v("div",{key:0,class:"text-base text-black whitespace-pre-wrap",innerHTML:g(W)(e.content.replace(/^\n\n/,""))},null,8,ie)):(d(),N(se,{key:1}))]))),256))],512)]),t("div",ce,[t("div",re,[c(i,{class:"input",rows:1,type:"textarea",ref_key:"myInput",ref:w,modelValue:g(f),"onUpdate:modelValue":s[0]||(s[0]=e=>z(f)?f.value=e:f=e),size:"large",onKeydown:s[1]||(s[1]=Y(e=>M(),["enter"])),disabled:g(B)},null,8,["modelValue","disabled"]),c(a,{onClick:s[2]||(s[2]=e=>M()),size:"large",type:"info",class:"elBtnStyle text-5xl ml-5"},{default:r(()=>[E("\u53D1\u9001 ")]),_:1})])])]),c(h,{modelValue:p.value,"onUpdate:modelValue":s[6]||(s[6]=e=>p.value=e),title:"\u795E\u5947\u6D77\u87BA \u8BBE\u7F6E",width:"40%",center:""},{footer:r(()=>[t("span",null,[c(a,{onClick:s[5]||(s[5]=e=>p.value=!1)},{default:r(()=>[E("\u5173\u95ED")]),_:1}),c(a,{type:"primary",onClick:I},{default:r(()=>[E("\u4FDD\u5B58")]),_:1})])]),default:r(()=>[t("div",de,[t("div",pe,[fe,c(i,{placeholder:"sk-xxxxxxxxxx",modelValue:g(n),"onUpdate:modelValue":s[3]||(s[3]=e=>z(n)?n.value=e:n=e),size:"large",clearable:""},null,8,["modelValue"])]),t("div",me,[ve,c(F,{size:"large",class:"w-full",modelValue:b.value,"onUpdate:modelValue":s[4]||(s[4]=e=>b.value=e)},{default:r(()=>[(d(!0),v(k,null,S(g(X),e=>(d(),N(m,{key:e.id,label:e.id,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue"])],64)}}});export{xe as default};
